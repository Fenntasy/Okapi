<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>API · Wapiti</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="API · Wapiti"/><meta property="og:type" content="website"/><meta property="og:url" content="https://Fenntasy.github.io/Wapiti/index.html"/><meta property="og:description" content="## Methods"/><link rel="shortcut icon" href="/Wapiti/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css"/><link rel="alternate" type="application/atom+xml" href="https://Fenntasy.github.io/blog/atom.xml" title="Wapiti Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://Fenntasy.github.io/blog/feed.xml" title="Wapiti Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/Wapiti/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/Wapiti/"><img class="logo" src="/Wapiti/img/logo.jpg"/><h2 class="headerTitle">Wapiti</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/Wapiti/docs/install.html" target="_self">Docs</a></li><li><a href="/Wapiti/docs/api.html" target="_self">API</a></li><li><a href="/Wapiti/blog" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>API Reference</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Getting Started</h3><ul><li class="navListItem"><a class="navItem" href="/Wapiti/docs/install.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/Wapiti/docs/why.html">Why Wapiti?</a></li></ul></div><div class="navGroup navGroupActive"><h3>Guides</h3><ul><li class="navListItem"><a class="navItem" href="/Wapiti/docs/vcr.html">Use with APIs</a></li><li class="navListItem"><a class="navItem" href="/Wapiti/docs/tabs.html">Multiple tabs</a></li></ul></div><div class="navGroup navGroupActive"><h3>API Reference</h3><ul><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/Wapiti/docs/api.html">All methods</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>API</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" name="methods"></a><a href="#methods" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Methods</h2>
<ul>
<li><a href="#wapiticapturefunc">Wapiti.capture(func)</a></li>
<li><a href="#wapiticaptureurl">Wapiti.captureUrl()</a></li>
<li><a href="#wapiticlickselector">Wapiti.click(selector)</a></li>
<li><a href="#wapiticlickandwaitfornewtabselector">Wapiti.clickAndWaitForNewTab(selector)</a></li>
<li><a href="#wapitifillformdata">Wapiti.fillForm(data)</a></li>
<li><a href="#wapitigotourl">Wapiti.goto(url)</a></li>
<li><a href="#wapitinexttab">Wapiti.nextTab()</a></li>
<li><a href="#wapitiprevioustab">Wapiti.previousTab()</a></li>
<li><a href="#wapitipuppeteerfunc">Wapiti.puppeteer(func)</a></li>
<li><a href="#wapitirun">Wapiti.run()</a></li>
<li><a href="#wapitisetupvcroptions">Wapiti.setupVCR(options)</a></li>
<li><a href="#wapititypeinselector-value">Wapiti.typeIn(selector, value)</a></li>
</ul>
<h4><a class="anchor" aria-hidden="true" name="wapiticapturefunc"></a><a href="#wapiticapturefunc" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.capture(func)</h4>
<p>Execute <code>func</code> on the current page and add an entry to the end result.
If only one <code>capture</code> call is done, the end result will be its value.
If several calls are made, the end result will be an array with all captures.</p>
<h4><a class="anchor" aria-hidden="true" name="wapiticaptureurl"></a><a href="#wapiticaptureurl" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.captureUrl()</h4>
<p>Convenience function for getting the URL of the page and adding it to the captures.
Functionnally equivalent to <code>Wapiti.capture(() =&gt; document.location.href)</code></p>
<h4><a class="anchor" aria-hidden="true" name="wapiticlickselector"></a><a href="#wapiticlickselector" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.click(selector)</h4>
<p>Click on the first result returned by <code>document.querySelector(selector)</code>.</p>
<h4><a class="anchor" aria-hidden="true" name="wapiticlickandwaitfornewtabselector"></a><a href="#wapiticlickandwaitfornewtabselector" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.clickAndWaitForNewTab(selector)</h4>
<p>Click on the first result returned by <code>document.querySelector(selector)</code> and wait for a tab to be opened before doing the rest of operations.
Beware that it will wait until your test timeout if no new tab is opened.</p>
<h4><a class="anchor" aria-hidden="true" name="wapitifillformdata"></a><a href="#wapitifillformdata" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.fillForm(data)</h4>
<p>Handle the work of filling a form and submiting it.
<code>data</code> is an object with input selectors as key and the desired input value as value.</p>
<pre><code class="hljs css javascript">Wapiti.goto(<span class="hljs-string">"http://localhost"</span>))
  .fillForm({
    <span class="hljs-string">"#firstInput"</span>: <span class="hljs-string">"test1"</span>, <span class="hljs-comment">// will result in &lt;input id="firstInput" value="test1" /&gt;</span>
    <span class="hljs-string">".secondInput"</span>: <span class="hljs-string">"test2"</span> <span class="hljs-comment">// will result in &lt;input class="secondInput" value="test2" /&gt;</span>
  })
</code></pre>
<p>The form in which these input belong will then be submitted and the resulting page will be waited for.
Please note that this function will only work if there is a real navigation occuring, if the submit event is hijacked, you will need to use <code>Wapiti.insert</code> and <code>Wapiti.click</code> instead.</p>
<h4><a class="anchor" aria-hidden="true" name="wapitigotourl"></a><a href="#wapitigotourl" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.goto(url)</h4>
<p>Go to a URL and resolve when there is no more network requests.</p>
<h4><a class="anchor" aria-hidden="true" name="wapitinexttab"></a><a href="#wapitinexttab" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.nextTab()</h4>
<p>Change tab by going to the next one.
If the browser was already on the last tab, it will go back to the first one.
If there is only one tab open, it will not do anything but display a warning.</p>
<h4><a class="anchor" aria-hidden="true" name="wapitiprevioustab"></a><a href="#wapitiprevioustab" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.previousTab()</h4>
<p>Change tab by going to the previous one.
If the browser was already on the first tab, it will go to the last one.
If there is only one tab open, it will not do anything but display a warning.</p>
<h4><a class="anchor" aria-hidden="true" name="wapitipuppeteerfunc"></a><a href="#wapitipuppeteerfunc" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.puppeteer(func)</h4>
<p>Allows you to use the puppeteer API yourself.
<code>func</code> will be passed the <code>page</code> object and the <code>browser</code> and you can use any method of the <a href="https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md">puppeteer API</a>.</p>
<p>In most cases, you should not need to wait for something with Wapiti (the defaults try to be enough) but if you need it, you can do it like this:</p>
<pre><code class="hljs css javascript">Wapiti.goto(<span class="hljs-string">"http://localhost"</span>))
  .puppeteer(<span class="hljs-function"><span class="hljs-params">page</span> =&gt;</span> page.waitFor(<span class="hljs-number">2000</span>))
</code></pre>
<h4><a class="anchor" aria-hidden="true" name="wapitirun"></a><a href="#wapitirun" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.run()</h4>
<p>Really start the chain of events and return a promise with that should resolve with either the result of the <code>capture</code> call or an array with the results of the <code>capture</code> calls.</p>
<h4><a class="anchor" aria-hidden="true" name="wapitisetupvcroptions"></a><a href="#wapitisetupvcroptions" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.setupVCR(options)</h4>
<p>Use the VCR for this test.</p>
<p><code>options</code> can be omited and defaults to:</p>
<pre><code class="hljs css javascript">{
  <span class="hljs-attr">fixturePath</span>: <span class="hljs-string">"./_fixtures"</span>,
  <span class="hljs-attr">mode</span>: <span class="hljs-string">"cache"</span>,
  <span class="hljs-attr">headerBlacklist</span>: [<span class="hljs-string">"authorization"</span>, <span class="hljs-string">"user-agent"</span>]
}
</code></pre>
<p>The <code>fixturePath</code> will be created if it does not exists and can be an absolute or relative path (starting from where you launch your tests).
<code>mode</code> can be either <code>cache</code> (attempts to read from the VCR and fetch it if not present), <code>record</code> (always fetch and record) or <code>playback</code> (always read from the VCR).</p>
<p>The VCR mode is still in development and will only work with calls done with <code>fetch</code> in your web app.
Furthermore, the promise produced by <code>fetch</code> can only use the <code>json</code> and <code>text</code> function in the ensuing <code>then</code>.
Please make an issue if you need something else.</p>
<p><code>headerBlacklist</code> is an array of keys that will be ignored in the fixtures and the request (whichever value they have will not be taken into account). These keys must be lowercase.</p>
<h4><a class="anchor" aria-hidden="true" name="wapititypeinselector-value"></a><a href="#wapititypeinselector-value" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Wapiti.typeIn(selector, value)</h4>
<p>Will insert <code>value</code> in the input found by <code>selector</code>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="tabs.html">← Multiple tabs</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/Wapiti/" class="nav-home"><img src="/Wapiti/img/logo.jpg" alt="Wapiti" width="66" height="58"/></a><div><h5>Docs</h5><a href="/Wapiti/docs/en/install.html">Getting Started</a><a href="/Wapiti/docs/vcr.html">Guides</a><a href="/Wapiti/docs/en/api.html">API Reference</a></div><div><h5>More</h5><a href="/Wapiti/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" href="git@github.com:Fenntasy/Wapiti.git" data-icon="octicon-star" data-count-href="/Fenntasy/Wapiti/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section></footer></div></body></html>